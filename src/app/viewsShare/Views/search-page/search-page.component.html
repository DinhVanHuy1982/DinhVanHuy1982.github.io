<div id="loadpagepr" [ngClass]="{'page-loading-class' : isLoading}">
  <div id="loadpage" class="bee-spinner-sc"></div>
</div>
<div class="search-page">
  <div class="container-fluid" style="padding-right: 0;">
    <div class="row" >
      <div class="col col-3 advance-filter">
        <div class="advance-filter-header">
          <div class="logo-filter">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M19.5 8.45703H4.5C4.15833 8.45703 3.875 8.1737 3.875 7.83203C3.875 7.49036 4.15833 7.20703 4.5 7.20703H19.5C19.8417 7.20703 20.125 7.49036 20.125 7.83203C20.125 8.1737 19.8417 8.45703 19.5 8.45703Z" fill="#101840"/>
              <path d="M17 12.625H7C6.65833 12.625 6.375 12.3417 6.375 12C6.375 11.6583 6.65833 11.375 7 11.375H17C17.3417 11.375 17.625 11.6583 17.625 12C17.625 12.3417 17.3417 12.625 17 12.625Z" fill="#101840"/>
              <path d="M13.6654 16.793H10.332C9.99036 16.793 9.70703 16.5096 9.70703 16.168C9.70703 15.8263 9.99036 15.543 10.332 15.543H13.6654C14.007 15.543 14.2904 15.8263 14.2904 16.168C14.2904 16.5096 14.007 16.793 13.6654 16.793Z" fill="#101840"/>
            </svg>
          </div>
          <div class="advance-filter-title">Bộ lọc tìm kiếm</div>
        </div>
        <div class="advance-filter-body">
          <div class="filter-rate">
            <div style="margin-bottom: 12px;">
              <span class="filter-seller__title">Theo đánh giá</span>
            </div>
            <div *ngFor="let item of listRate" style="margin-bottom: 2px;">
              <mat-checkbox class="filter-rate__checkbox" [(ngModel)]="item.checked" (change)="updateSearchRate()">
                <div style="display: inline-block;" [innerHtml]="item.svg"></div>
                <span class="checkbox-text">{{item.name}} {{item.name != 5 ? 'trở lên' : 'sao' }}</span>
              </mat-checkbox>
            </div>
          </div>
          <div class="filter-price">
            <span class="filter-seller__title">Lọc theo giá</span>
            <div class="range-price">
              <div class="range-price__from">
                <span class="price-form">Từ</span>
                <!--                              <input type="text" class="text-truncate" [(ngModel)]="priceFrom" maxlength="20"-->
                <!--                                     oninput="this.value = this.value.replace(/[^0-9]/g, '').replace(/(\..*?)\..*/g, '$1');"-->
                <!--                                     [matTooltip]="priceFrom ? priceFrom + ' ₭' : '' "-->
                <!--                                     (change)="changePrice(1)"-->
                <!--                                     [ngClass]="{'padding-from': lang === 'en'}"-->
                <!--                                     (ngModelChange)="onChangePrice()">-->

                <input type="text"
                       class="text-truncate"
                       [(ngModel)]="searchProduct.fromPrice"
                       maxlength="20"
                       [matTooltip]="searchProduct.fromPrice ? searchProduct.fromPrice + ' VND' : '' "
                       (change)="fomatPrice()"
                />
                <span class="kip">VND</span>
              </div>
              <span> - </span>
              <div class="range-price__to">
                <span class="price-to">Đến</span>
                <!--                                <input type="text" class="text-truncate" style="padding-left: 39px;" [(ngModel)]="priceTo"-->
                <!--                                    maxlength="20"-->
                <!--                                    [matTooltip]="priceTo ? priceTo + ' ₭' : '' "-->
                <!--                                    (change)="changePrice(2)"-->
                <!--                                    (ngModelChange)="onChangePrice()"-->
                <!--                                       oninput="this.value = this.value.replace(/[^0-9]/g, '').replace(/(\..*?)\..*/g, '$1');"-->
                <!--                                >-->

                <input type="text"
                       class="text-truncate"
                       style="padding-left: 39px;"
                       [(ngModel)]="searchProduct.toPrice"
                       maxlength="20"
                       [matTooltip]="searchProduct?.toPrice ? searchProduct?.toPrice + ' VND' : '' "
                       (change)="fomatPrice()"
                />
                <span class="kip">VND</span>
              </div>
            </div>
            <span *ngIf="priceInvalid" style="padding: 2px; color: #D14343;">Giá từ phải nhỏ hơn hoặc bằng giá đến</span>
          </div>
        </div>
        <div class="advance-filter-footer">
          <div class="btn-group">
            <!-- <button class="btn-apply" [disabled]="(sellers == '' && priceDisable) || priceInvalid"
                [ngClass]="{'disabled-apply': (sellers == '' && priceDisable) || priceInvalid}"
                (click)="onApplyCondition(1)">{{'PACKAGE_EXAM.APPLY'|translate}}</button>
            <button class="btn-clear" (click)="onClearSearch()">{{'SEARCH.FILTER.CLEAR_FILTER'|translate}}</button> -->
            <button class="btn-apply" (click)="onApplyCondition(1)">Áp dụng</button>
            <button class="btn-clear" (click)="onClearSearch()">Xóa bộ lọc</button>
          </div>
        </div>
      </div>
      <div class="search-container">
        <div class="filter-item" *ngIf="lstProduct.length>0">
          <span class="filter-seller__title">Các sản phẩm liên quan đến <span class="keyword">"{{this.searchProduct.nameSearch}}"</span></span>
          <div class="sort-by">
            <span class="sort-by__title">Lọc theo</span>
            <div class="btn-group">
              <button class="btn-sort" (click)="sortBy('productName')" [class.styleChoose]="searchProduct.propertySort === 'productName'">Tên sản phẩm</button>
              <button class="btn-sort" (click)="sortBy('avgRating')" [class.styleChoose]="searchProduct.propertySort === 'avgRating'">Đánh giá</button>
              <button class="btn-sort" (click)="sortBy('price')" [class.styleChoose]="searchProduct.propertySort === 'price'">Giá</button>
              <button class="btn-sort" (click)="sortBy('buyQuantity')" [class.styleChoose]="searchProduct.propertySort === 'buyQuantity'">Đã bán</button>
            </div>
          </div>
          <div class="item-container row" >
            <!--
              type: 0 gói đề thi
              type: 3 sách
              type: 2 khóa học
            -->
            <ng-container *ngFor="let item of lstProduct; let index = index"
                          [ngTemplateOutletContext]="{item: item, index: index}"
                          [ngTemplateOutlet]="examPackageItem">
            </ng-container>
          </div>
          <div class="row paginate-search" style="margin: 6px 0 0;">
            <app-panigation [total]="totalElement" [totalPage]="this.totalPage" [dataLength]="lstProduct?.length"
                            [currentPage]="1" [collapse]="false" [pageSize]="10"
                            (paginate)="callInforReview(null, $event)">
            </app-panigation>
          </div>
        </div>

        <div class="no-record"  *ngIf="lstProduct?.length ===0">
          <div>
            <div class="template-no-row">
              <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5.69873 25H30.2467V48H7.45215C6.98712 48 6.54113 47.8136 6.2123 47.4818C5.88347 47.15 5.69873 46.7 5.69873 46.2308V25Z" fill="#C1C4D6"/>
                <path d="M30.2466 25H42.5206V46.2308C42.5206 46.7 42.3358 47.15 42.007 47.4818C41.6782 47.8136 41.2322 48 40.7671 48H30.2466V25Z" fill="#8F95B2"/>
                <path d="M30.2466 25L35.726 31.1923H48L42.5206 25H30.2466Z" fill="#D8DAE5"/>
                <path d="M30.4658 25L24.9863 31.1923H0L5.47945 25H30.4658Z" fill="#D8DAE5"/>
                <path d="M24 20C29.5228 20 34 15.5228 34 10C34 4.47715 29.5228 0 24 0C18.4772 0 14 4.47715 14 10C14 15.5228 18.4772 20 24 20Z" fill="#C1C4D6"/>
                <path d="M23.7475 6.84449L24.0657 7.3131L24.3827 6.84449C24.5962 6.62203 24.8523 6.44481 25.1358 6.32338C25.4192 6.20196 25.7242 6.13881 26.0325 6.13771C26.3409 6.13661 26.6463 6.19756 26.9306 6.31696C27.2149 6.43635 27.4723 6.61173 27.6874 6.83266L27.7514 6.89359C28.2155 7.3479 28.4821 7.9666 28.4937 8.61593C28.5053 9.26526 28.2608 9.89307 27.8132 10.3636L27.7514 10.4267L24.0657 14.0274L20.4712 10.4267C20.2361 10.1965 20.0493 9.92169 19.9217 9.61834C19.7942 9.31499 19.7285 8.98923 19.7285 8.66017C19.7285 8.3311 19.7942 8.00534 19.9217 7.70199C20.0493 7.39864 20.2361 7.1238 20.4712 6.89359C20.6743 6.66067 20.9242 6.4731 21.2045 6.34306C21.4848 6.21301 21.7894 6.14342 22.0984 6.13879C22.4074 6.13416 22.7139 6.1946 22.998 6.31618C23.2821 6.43776 23.5375 6.61777 23.7475 6.84449Z" fill="white"/>
                <defs>
                  <clipPath id="clip0">
                    <rect width="48" height="48" fill="white"/>
                  </clipPath>
                </defs>
              </svg>
              <p style='margin-top: 6px;'>Khôn tồn tại sản phẩm nào</p>
            </div>
          </div>
          <div class="no-record-message">
            Hãy sử dụng từ khóa khác
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #examPackageItem let-item="item" let-index="index">
  <div class="item-box col-sm-6 col-md-6 col-lg-4 col-xl-3 course-item" (click)="viewFile(item)">
    <div class="item-box__img" [ngClass]="{'no-avatar':!item.fileName}">
      <img src="{{item.fileName}}">
      <div class="status-test-package">
        <span class="status1" *ngIf="item.purchase">{{- item.purchase }}%</span>
        <span class="status2" *ngIf="item.rankBestSeller && item?.rankBestSeller <= 10 ">{{'ULEARN.LANDING_PAGE.HOME_PAGE.BEST_SELLERS'|translate}}</span>
      </div>
    </div>
    <span class="item-box__title" [matTooltip]="item.brandName"  matTooltipClass="material-tooltip">{{item.brandName}}</span>
    <div class="item-box__rate">
            <span class="ratio-rate" *ngIf="item.avgRating > 0">
                <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.10276 4.10575C6.94719 2.59091 7.36941 1.8335 8.00065 1.8335C8.63189 1.8335 9.05411 2.59091 9.89854 4.10575L10.117 4.49765C10.357 4.92812 10.4769 5.14335 10.664 5.28537C10.8511 5.42738 11.0841 5.4801 11.5501 5.58553L11.9743 5.68152C13.6141 6.05253 14.434 6.23804 14.629 6.86532C14.8241 7.49259 14.2652 8.14621 13.1473 9.45345L12.858 9.79164C12.5404 10.1631 12.3815 10.3489 12.3101 10.5786C12.2386 10.8084 12.2626 11.0562 12.3107 11.5519L12.3544 12.0031C12.5234 13.7472 12.6079 14.6193 12.0972 15.007C11.5865 15.3947 10.8189 15.0412 9.28354 14.3343L8.88633 14.1514C8.45003 13.9505 8.23189 13.8501 8.00065 13.8501C7.76942 13.8501 7.55127 13.9505 7.11498 14.1514L6.71777 14.3343C5.18243 15.0412 4.41477 15.3947 3.90408 15.007C3.3934 14.6193 3.4779 13.7472 3.64692 12.0031L3.69064 11.5519C3.73867 11.0562 3.76268 10.8084 3.69123 10.5786C3.61977 10.3489 3.46093 10.1631 3.14326 9.79164L2.85405 9.45345C1.73615 8.14621 1.1772 7.49259 1.37227 6.86532C1.56733 6.23804 2.38722 6.05253 4.02701 5.68152L4.45124 5.58553C4.91722 5.4801 5.15021 5.42738 5.33728 5.28537C5.52435 5.14335 5.64433 4.92812 5.8843 4.49765L6.10276 4.10575Z" fill="#F3A412"/>
                </svg>
              {{item.avgRating.toFixed(1)}}
            </span>
      <span class="item-sold">Đã bán: {{item.buyQuantity?item.buyQuantity: 0}}</span>
    </div>
    <div class="item-box__content" [matTooltip]="item.productName"  matTooltipClass="material-tooltip">{{item.productName}}</div>
    <div class="item-box__detail d-flex flex-column">
      <div style="text-transform: lowercase; height: 18px;">
        <div *ngIf="item.infoProduct1 !== 0" style="overflow: hidden;"  class="d-flex align-items-center" [matTooltip]="item.infoProduct1 > 1 ? item.infoProduct1 + ' ' + ('PACKAGE_EXAM_USER.EXAMS' | translate) : item.infoProduct1 + ' ' + ('PACKAGE_EXAM_USER.EXAM' | translate)">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M1.33398 8.00016V5.3335C1.33398 3.44788 1.33398 2.50507 1.91977 1.91928C2.50556 1.3335 3.44837 1.3335 5.33398 1.3335H10.6673C12.5529 1.3335 13.4957 1.3335 14.0815 1.91928C14.6673 2.50507 14.6673 3.44788 14.6673 5.3335V8.00016C14.6673 9.88578 14.6673 10.8286 14.0815 11.4144C13.764 11.7319 13.3415 11.8773 12.7208 11.9439C12.6715 11.8773 12.6248 11.8249 12.5915 11.7882C12.514 11.7031 12.4158 11.6063 12.3207 11.5124L11.3253 10.5309L10.9578 10.1586C10.7162 8.74359 9.48433 7.66683 8.00069 7.66683C6.51706 7.66683 5.28519 8.74359 5.04362 10.1586L4.67606 10.5309L3.68078 11.5124C3.58558 11.6062 3.48737 11.7031 3.40993 11.7882C3.37662 11.8249 3.32992 11.8773 3.28058 11.9439C2.65983 11.8773 2.23734 11.7319 1.91977 11.4144C1.33398 10.8286 1.33398 9.88578 1.33398 8.00016ZM6.00065 3.50016C5.72451 3.50016 5.50065 3.72402 5.50065 4.00016C5.50065 4.27631 5.72451 4.50016 6.00065 4.50016H10.0007C10.2768 4.50016 10.5007 4.27631 10.5007 4.00016C10.5007 3.72402 10.2768 3.50016 10.0007 3.50016H6.00065ZM4.16732 6.3335C4.16732 6.05735 4.39118 5.8335 4.66732 5.8335H11.334C11.6101 5.8335 11.834 6.05735 11.834 6.3335C11.834 6.60964 11.6101 6.8335 11.334 6.8335H4.66732C4.39118 6.8335 4.16732 6.60964 4.16732 6.3335Z" fill="#F9A886"/>
            <path d="M10.0007 10.6668C10.0007 11.7714 9.10522 12.6668 8.00065 12.6668C6.89608 12.6668 6.00065 11.7714 6.00065 10.6668C6.00065 9.56226 6.89608 8.66683 8.00065 8.66683C9.10522 8.66683 10.0007 9.56226 10.0007 10.6668Z" fill="#F9A886"/>
            <path d="M6.00139 10.6118C6.0009 10.6301 6.00065 10.6484 6.00065 10.6668C6.00065 11.7714 6.89608 12.6668 8.00065 12.6668C9.10522 12.6668 10.0007 11.7714 10.0007 10.6668C10.0007 10.6484 10.0004 10.6301 9.99991 10.6118C9.97074 9.53266 9.08681 8.66683 8.00065 8.66683C6.96512 8.66683 6.1134 9.45383 6.01098 10.4623C6.00597 10.5116 6.00275 10.5615 6.00139 10.6118Z" fill="#F9A886"/>
            <path d="M5.11778 11.4997L4.39747 12.21C4.18143 12.4231 4.0734 12.5296 4.03602 12.6198C3.95084 12.8254 4.02374 13.0534 4.2092 13.1615C4.29059 13.209 4.4374 13.2238 4.73101 13.2533C4.89678 13.27 4.97967 13.2784 5.04909 13.3037C5.20451 13.3605 5.32542 13.4797 5.38295 13.633C5.40865 13.7014 5.41712 13.7832 5.43405 13.9466C5.46404 14.2362 5.47904 14.3809 5.52716 14.4612C5.63682 14.6441 5.86806 14.7159 6.07652 14.6319C6.168 14.5951 6.27602 14.4886 6.49207 14.2755L7.21235 13.5622C6.20402 13.2883 5.40677 12.5018 5.11778 11.4997Z" fill="#F9A886"/>
            <path d="M8.78895 13.5622L9.50923 14.2755C9.72528 14.4886 9.8333 14.5951 9.92478 14.6319C10.1332 14.7159 10.3645 14.6441 10.4741 14.4612C10.5223 14.3809 10.5373 14.2362 10.5673 13.9466C10.5842 13.7832 10.5927 13.7014 10.6184 13.633C10.6759 13.4797 10.7968 13.3605 10.9522 13.3037C11.0216 13.2784 11.1045 13.27 11.2703 13.2533C11.5639 13.2238 11.7107 13.209 11.7921 13.1615C11.9776 13.0534 12.0505 12.8254 11.9653 12.6198C11.9279 12.5296 11.8199 12.4231 11.6038 12.21L10.8835 11.4997C10.5945 12.5018 9.79728 13.2883 8.78895 13.5622Z" fill="#F9A886"/>
          </svg>
          <span> {{item.infoProduct1}} {{ item.infoProduct1 > 1 ? ('PACKAGE_EXAM_USER.EXAMS' | translate) :  ('PACKAGE_EXAM_USER.EXAM' | translate) }}</span>
        </div>
      </div>
<!--      <div style="height: 18px; text-transform: lowercase;">-->
<!--        <div *ngIf="item.infoProduct2 !== 0" style="overflow: hidden;"  class="d-flex align-items-center" [matTooltip]="item.infoProduct2 > 1 ? item.infoProduct2 + ' ' + ('PACKAGE_EXAM_USER.FREE_EXAMS' | translate) : item.infoProduct2 + ' ' + ('PACKAGE_EXAM_USER.FREE_EXAM' | translate)" >-->
<!--          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">-->
<!--            <path fill-rule="evenodd" clip-rule="evenodd" d="M14 7.39851V10.7274C14 12.7918 14 13.824 13.5106 14.275C13.2772 14.4901 12.9826 14.6253 12.6687 14.6612C12.0107 14.7365 11.2422 14.0568 9.70523 12.6974C9.02585 12.0965 8.68617 11.796 8.29315 11.7169C8.09962 11.6779 7.90038 11.6779 7.70685 11.7169C7.31383 11.796 6.97415 12.0965 6.29477 12.6974C4.75782 14.0568 3.98935 14.7365 3.33128 14.6612C3.01743 14.6253 2.72281 14.4901 2.4894 14.275C2 13.824 2 12.7918 2 10.7274V7.39851C2 4.53943 2 3.1099 2.87868 2.2217C3.75736 1.3335 5.17157 1.3335 8 1.3335C10.8284 1.3335 12.2426 1.3335 13.1213 2.2217C14 3.1099 14 4.53943 14 7.39851ZM5.5 4.00016C5.5 3.72402 5.72386 3.50016 6 3.50016H10C10.2761 3.50016 10.5 3.72402 10.5 4.00016C10.5 4.27631 10.2761 4.50016 10 4.50016H6C5.72386 4.50016 5.5 4.27631 5.5 4.00016Z" fill="#F9A886"/>-->
<!--          </svg>-->
<!--          <span> {{item.infoProduct2}} {{ item.infoProduct2 > 1 ? ('PACKAGE_EXAM_USER.FREE_EXAMS' | translate) :  ('PACKAGE_EXAM_USER.FREE_EXAM' | translate) }}</span>-->
<!--        </div>-->
<!--      </div>-->
    </div>
    <div class="item-box__price">
      <span class="item-price" [ngClass]="item.priceSale!==0? 'price-sale':''">{{item.price}}VND</span>
      <span class="item-price" *ngIf="item.priceSale!==0">{{item.priceSale}}VND</span>

    </div>
    <!-- <div> -->
    <!--            <button class="btn-addcart" (click)="addToCart(item.code,$event)">{{'INFOR_SELLER.ADD_TO_CART'|translate}}-->
    <!--                <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">-->
    <!--                    <g clip-path="url(#clip0_35033_55516)">-->
    <!--                    <path d="M14.1243 2.37825C13.9602 2.18134 13.7547 2.02297 13.5226 1.91439C13.2904 1.80581 13.0371 1.74969 12.7808 1.75H3.3495L3.325 1.54525C3.27486 1.11966 3.07031 0.72726 2.75012 0.442445C2.42993 0.15763 2.01637 0.00019938 1.58783 0L1.45833 0C1.30362 0 1.15525 0.0614582 1.04585 0.170854C0.936458 0.280251 0.875 0.428624 0.875 0.583333C0.875 0.738043 0.936458 0.886416 1.04585 0.995812C1.15525 1.10521 1.30362 1.16667 1.45833 1.16667H1.58783C1.73071 1.16669 1.86861 1.21914 1.97538 1.31408C2.08215 1.40903 2.15037 1.53985 2.16708 1.68175L2.96975 8.50675C3.05308 9.21654 3.39411 9.87104 3.92811 10.346C4.46211 10.821 5.15192 11.0833 5.86658 11.0833H11.9583C12.113 11.0833 12.2614 11.0219 12.3708 10.9125C12.4802 10.8031 12.5417 10.6547 12.5417 10.5C12.5417 10.3453 12.4802 10.1969 12.3708 10.0875C12.2614 9.97812 12.113 9.91667 11.9583 9.91667H5.86658C5.50553 9.91565 5.15363 9.80299 4.85913 9.59412C4.56462 9.38525 4.34193 9.0904 4.22158 8.75H11.1749C11.8588 8.75004 12.5209 8.5098 13.0456 8.07125C13.5703 7.63271 13.9242 7.02374 14.0455 6.35075L14.5034 3.81092C14.5491 3.55892 14.5389 3.29996 14.4733 3.05237C14.4078 2.80479 14.2886 2.57464 14.1243 2.37825ZM13.3583 3.60383L12.8998 6.14367C12.827 6.54792 12.6143 6.91366 12.2989 7.17687C11.9836 7.44007 11.5857 7.58396 11.1749 7.58333H4.03608L3.48717 2.91667H12.7808C12.8665 2.91615 12.9513 2.93453 13.0291 2.97048C13.1068 3.00644 13.1758 3.05909 13.2309 3.12469C13.286 3.19029 13.326 3.26723 13.3481 3.35005C13.3701 3.43286 13.3736 3.51951 13.3583 3.60383Z" fill="#F26522"/>-->
    <!--                    <path d="M4.95768 14.0003C5.60201 14.0003 6.12434 13.478 6.12434 12.8337C6.12434 12.1893 5.60201 11.667 4.95768 11.667C4.31335 11.667 3.79102 12.1893 3.79102 12.8337C3.79102 13.478 4.31335 14.0003 4.95768 14.0003Z" fill="#F26522"/>-->
    <!--                    <path d="M10.7917 14.0003C11.436 14.0003 11.9583 13.478 11.9583 12.8337C11.9583 12.1893 11.436 11.667 10.7917 11.667C10.1473 11.667 9.625 12.1893 9.625 12.8337C9.625 13.478 10.1473 14.0003 10.7917 14.0003Z" fill="#F26522"/>-->
    <!--                    </g>-->
    <!--                    <defs>-->
    <!--                    <clipPath id="clip0_35033_55516">-->
    <!--                    <rect width="14" height="14" fill="white" transform="translate(0.875)"/>-->
    <!--                    </clipPath>-->
    <!--                    </defs>-->
    <!--                </svg>-->
    <!--            </button>-->
    <!-- </div> -->
  </div>
</ng-template>
